-- Я не включил метрику workshop_utilization_percent, которая показывает,
-- насколько эффективно используется мастерская по времени.
-- Я реализовал корреляцию вручную через формулу вместо использования встроенной функции CORR().
-- Создал слишком много промежуточных CTE — возможно, 6 это перебор,
-- когда можно было сделать структуру компактнее. Хотя это определённо добавляет читабельности.
-- Добавил проверки на деление на ноль и обработку NULL значений через CASE WHEN и COALESCE. 
-- Это делает запрос более надежным при работе с неполными данными.
-- Добавил сортировку в JSON массивы для консистентности результатов.
